(()=>{var S=Object.defineProperty;var v=(l,e,s)=>e in l?S(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var t=(l,e,s)=>v(l,typeof e!="symbol"?e+"":e,s);var a=class a{constructor(e,s,i,n){t(this,"open",()=>{this._isOpen=!0,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"close",()=>{this._isOpen=!1,this.setAriaOpen(),this.changeFocus(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"closeWithoutFocus",()=>{this._isOpen=!1,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"toggle",e=>{a.isClick(e.which)&&(this.isOpen?this.close():this.open())});t(this,"handleLinkAnchor",e=>{if(!e||e.length===0)return;let s=this.element.querySelector(e);s&&(this.open(),s.scrollIntoView())});t(this,"setAriaOpen",()=>{a.ariaExpandedElements.forEach(e=>{this.element.getElementsByClassName(e)[0].setAttribute("aria-expanded",this.isOpen)})});t(this,"setHidden",e=>{let s=this.element.closest(".accordion"),i=this.element.getElementsByClassName(a.contentElement)[0];if(e){s.style.setProperty("--js-accordion-open-time","0s"),document.body.offsetHeight,this.isOpen?i.removeAttribute("hidden"):i.hidden="until-found",setTimeout(()=>{s.style.removeProperty("--js-accordion-open-time")},10);return}if(this.isOpen)i.removeAttribute("hidden");else{let n=parseInt(getComputedStyle(s).getPropertyValue("--js-accordion-open-time"),10)||200;setTimeout(()=>{i.hidden="until-found"},n)}});t(this,"changeFocus",()=>this.element.querySelector(`.${a.toggleElement}`).focus());t(this,"addEventListeners",()=>{let e=this.element.getElementsByClassName(a.toggleElement)[0];e.addEventListener("mouseup",this.toggle),e.addEventListener("keypress",this.toggle);let s=this.element.getElementsByClassName(a.closeElement),i=s[s.length-1];i.addEventListener("mouseup",this.close),i.addEventListener("keypress",this.close)});this.element=e,this.localState=s,this.parentCallback=n,this._id=e.dataset.accordionId,this._isOpen=this.localState.loadItemState(this._id),this.setHidden(!0),this.addEventListeners(),this.handleLinkAnchor(i),this.setAriaOpen()}static isClick(e){return e===1||e===13||e===32}get id(){return this._id}get isOpen(){return this._isOpen}};t(a,"accordionItemElement","helfi-accordion-item"),t(a,"toggleElement","accordion-item__button--toggle"),t(a,"closeElement","accordion-item__button--close"),t(a,"ariaExpandedElements",["accordion-item__button--toggle"]),t(a,"contentElement","accordion-item__content");var r=a;var O={open_all:{fi:"Avaa kaikki",en:"Open all",sv:"Öppna alla"},close_all:{fi:"Sulje kaikki",en:"Close all",sv:"Stäng alla"}},g=O;var m=class l{constructor(e){t(this,"saveEventKey","localstorage-save-event");t(this,"loadOnChange",()=>{this.loadData()});t(this,"triggerSaveEvent",()=>{dispatchEvent(new CustomEvent(this.saveEventKey))});t(this,"loadData",()=>{let e=null;try{e=localStorage.getItem(this.storageKey)}catch(s){l.handleError(s)}this.data=e?JSON.parse(e):{}});t(this,"saveData",()=>{try{localStorage.setItem(this.storageKey,JSON.stringify(this.data)),this.triggerSaveEvent()}catch(e){l.handleError(e)}});t(this,"setValue",(e,s)=>{this.data[e]=s,this.saveData()});t(this,"addValue",(e,s)=>{this.data[e]||(this.data[e]=[]),typeof s=="string"&&!this.data[e].includes(s)&&(this.data[e].push(s),this.saveData())});t(this,"getValue",e=>this.data[e]||null);t(this,"getValues",e=>this.data[e]||null);t(this,"removeValue",(e,s)=>{if(this.data[e]){let i=this.data[e].indexOf(s);i>-1&&(this.data[e].splice(i,1),this.saveData())}});this.data={},this.storageKey=e,this.loadData(),addEventListener(this.saveEventKey,this.loadOnChange)}static handleError(e){if(!(e instanceof ReferenceError))throw e}};var u=class u{constructor(){t(this,"getStorageKey",()=>`${this.site}-accordion`);t(this,"saveItemState",(e,s)=>{if(!this.site)return!1;this.siteAccordionStates[this.page]||(this.siteAccordionStates[this.page]={}),s===!1?delete this.siteAccordionStates[this.page][e]:this.siteAccordionStates[this.page][e]=s,this.storageManager.setValue(this.getStorageKey(),JSON.stringify(this.siteAccordionStates))});t(this,"loadItemState",e=>this.AccordionsOpen?!0:this.site?!!this.pageAccordionStates[e]:!1);this.storageManager=new m("helfi-settings"),this.site=window.drupalSettings.helfi_instance_name||"",this.page=window.drupalSettings.path.currentPath,this.siteAccordionStates=JSON.parse(this.storageManager.getValue(this.getStorageKey()))||{},this.pageAccordionStates=this.siteAccordionStates[this.page]||{},this.AccordionsOpen=u.isCookieSet("helfi_accordions_open")}};t(u,"isCookieSet",e=>{let i=document.cookie.split("; ");for(let n=0;n<i.length;n++)if(i[n].split("=")[0]===e)return!0;return!1}),t(u,"getCurrentLanguage",()=>window.drupalSettings.path.currentLanguage);var d=u;var o=class o{constructor(e,s,i,n="default"){t(this,"initializeAccordion",()=>{let e=this.accordion.getElementsByClassName(r.accordionItemElement);this.isSingleItemAccordion=e.length===1,Array.from(e).forEach(s=>{this.accordionItems.push(new r(s,this.localState,this.urlHash,this.updateToggleButtonLabel))}),"onbeforematch"in document.body&&this.enableHiddenUntilFound()});t(this,"enableHiddenUntilFound",()=>{this.accordionItems.forEach(e=>{e.element.classList.add("accordion-item--hidden-until-found");let s=e.element.querySelector(".accordion-item__content");e.isOpen||(s.hidden="until-found"),e.element.addEventListener("beforematch",()=>{e.element.style.setProperty("--js-accordion-open-time","0s"),e.element.offsetHeight,e.open(),setTimeout(()=>{e.element.style.removeProperty("--js-accordion-open-time")},10)})})});t(this,"addEventListeners",()=>{if(o.isHeaderless(this.type)||this.isSingleItemAccordion)return;let e=this.accordion.getElementsByClassName(o.toggleAllElement)[0];e.addEventListener("mouseup",this.toggleItems),e.addEventListener("keypress",this.toggleItems)});t(this,"addChildAccordion",e=>{this.childAccordion=e});t(this,"showToggleButton",()=>{o.isHeaderless(this.type)||this.isSingleItemAccordion?this.accordion.getElementsByClassName(o.toggleAllElement)[0]?.classList.add("is-hidden"):this.accordion.getElementsByClassName(o.toggleAllElement)[0]?.classList.remove("is-hidden")});t(this,"updateToggleButtonLabel",()=>{let e=this.accordion.getElementsByClassName(o.toggleAllElement)[0];e&&(this.areAllItemsOpen()?e.querySelector("span").textContent=g.close_all?.[this.currentLanguage]??g.close_all.en:e.querySelector("span").textContent=g.open_all?.[this.currentLanguage]??g.open_all.en,this.toggleAllLabelUpdate())});t(this,"getAccordionItemById",e=>this.accordionItems.find(s=>s.id===e));t(this,"toggleItems",()=>this.areAllItemsOpen()?this.closeAll():this.openAll());t(this,"openAll",()=>{this.accordionItems.forEach(e=>e.open()),this.childAccordion?.openAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate()});t(this,"closeAll",()=>{this.accordionItems.forEach(s=>s.closeWithoutFocus()),this.childAccordion?.closeAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate(),this.accordion.getElementsByClassName(o.toggleAllElement)[0].focus()});t(this,"toggleAllLabelUpdate",()=>{let e=this.accordion.getElementsByClassName(o.toggleAllElement)[0];e&&this.areAllItemsOpen()?(e.classList.remove(o.toggleAllClosed),e.classList.add(o.toggleAllOpen)):(e.classList.remove(o.toggleAllOpen),e.classList.add(o.toggleAllClosed))});t(this,"areAllItemsOpen",()=>this.accordionItems?.every(e=>e.isOpen)&&this.areChildItemsOpen());t(this,"areChildItemsOpen",()=>this.childAccordion?.areAllItemsOpen()??this.accordionItems?.every(e=>e.isOpen));t(this,"isHardcoded",()=>this.type==="hardcoded");this.type=n,this.isSingleItemAccordion=!1,this.currentLanguage=d.getCurrentLanguage(),this.accordion=e,this.localState=s,this.accordionItems=[],this.childAccordion=null,this.urlHash=i,this.initializeAccordion(i),this.addEventListeners(),this.showToggleButton(),this.updateToggleButtonLabel()}};t(o,"accordionWrapper","component--accordion"),t(o,"toggleAllElement","js-accordion__button--toggle-all"),t(o,"toggleAllOpen","accordion__button--is-open"),t(o,"toggleAllClosed","accordion__button--is-closed"),t(o,"headerlessTypes",["headerless","hardcoded"]),t(o,"isHeaderless",e=>o.headerlessTypes.includes(e));var h=o;var A=class A{constructor(){A.handleTableOfContentsHash()}};t(A,"handleTableOfContentsHash",()=>{window.addEventListener("hashchange",()=>{let{hash:e}=window.location;if(!e||e.length<2)return;let s=!1;if(window.helfiAccordions.forEach(i=>{let n=i.getAccordionItemById(e.replace("#",""));n&&(s=!0,n.handleLinkAnchor(e))}),!s){let i=document.querySelector(`${e}`);if(!i)return;let n=i.closest(`.${r.accordionItemElement}`);n&&window.helfiAccordions.forEach(c=>{let E=n.querySelector(".helfi-accordion__header").id,f=c.getAccordionItemById(E);f&&f.handleLinkAnchor()})}})});var p=A;window.helfiAccordions=[];var L=new d,X=new p,{hash:C}=window.location,w=l=>l.includes("component--no-header")?"headerless":l.includes("component--hardcoded")?"hardcoded":"default",I=(l,e)=>{let s=document.querySelectorAll(`.${h.accordionWrapper}`);if(s.length>window.helfiAccordions.length)try{s.forEach((i,n)=>{let c=w(Array.from(i.classList)),E=h.isHeaderless(c),f=n===0&&c!=="hardcoded"?"default":c,y=new h(i,L,C,f);window.helfiAccordions.push(y),!y.isHardcoded(c)&&E&&n>0&&window.helfiAccordions[n-1].addChildAccordion(y)})}catch(i){console.error(i),e.disconnect()}},b=document.body,k={attributes:!0,childList:!0,subtree:!0},B=new MutationObserver(I);B.observe(b,k);})();
