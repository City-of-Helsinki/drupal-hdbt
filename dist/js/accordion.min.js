(()=>{var O=Object.defineProperty;var L=(r,e,i)=>e in r?O(r,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[e]=i;var s=(r,e)=>O(r,"name",{value:e,configurable:!0});var t=(r,e,i)=>L(r,typeof e!="symbol"?e+"":e,i);var l=class l{constructor(e,i,o,a){t(this,"open",s(()=>{this._isOpen=!0,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)},"open"));t(this,"close",s(()=>{this._isOpen=!1,this.setAriaOpen(),this.changeFocus(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)},"close"));t(this,"closeWithoutFocus",s(()=>{this._isOpen=!1,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)},"closeWithoutFocus"));t(this,"toggle",s(e=>{l.isClick(e.which)&&(this.isOpen?this.close():this.open())},"toggle"));t(this,"handleLinkAnchor",s(e=>{if(!e||e.length===0)return;let i=this.element.querySelector(e);i&&(this.open(),i.scrollIntoView())},"handleLinkAnchor"));t(this,"setAriaOpen",s(()=>{l.ariaExpandedElements.forEach(e=>{this.element.getElementsByClassName(e)[0].setAttribute("aria-expanded",this.isOpen)})},"setAriaOpen"));t(this,"setHidden",s(e=>{let i=this.element.closest(".accordion"),o=this.element.getElementsByClassName(l.contentElement)[0];if(e){i.style.setProperty("--js-accordion-open-time","0s"),document.body.offsetHeight,this.isOpen?o.removeAttribute("hidden"):o.hidden="until-found",setTimeout(()=>{i.style.removeProperty("--js-accordion-open-time")},10);return}if(this.isOpen)o.removeAttribute("hidden");else{let a=parseInt(getComputedStyle(i).getPropertyValue("--js-accordion-open-time"),10)||200;setTimeout(()=>{o.hidden="until-found"},a)}},"setHidden"));t(this,"changeFocus",s(()=>this.element.querySelector(`.${l.toggleElement}`).focus(),"changeFocus"));t(this,"addEventListeners",s(()=>{let e=this.element.getElementsByClassName(l.toggleElement)[0];e.addEventListener("mouseup",this.toggle),e.addEventListener("keypress",this.toggle);let i=this.element.getElementsByClassName(l.closeElement),o=i[i.length-1];o.addEventListener("mouseup",this.close),o.addEventListener("keypress",this.close)},"addEventListeners"));this.element=e,this.localState=i,this.parentCallback=a,this._id=e.dataset.accordionId,this._isOpen=this.localState.loadItemState(this._id),this.setHidden(!0),this.addEventListeners(),this.handleLinkAnchor(o),this.setAriaOpen()}static isClick(e){return e===1||e===13||e===32}get id(){return this._id}get isOpen(){return this._isOpen}};s(l,"AccordionItem"),t(l,"accordionItemElement","helfi-accordion-item"),t(l,"toggleElement","accordion-item__button--toggle"),t(l,"closeElement","accordion-item__button--close"),t(l,"ariaExpandedElements",["accordion-item__button--toggle"]),t(l,"contentElement","accordion-item__content");var c=l;var C={open_all:{fi:"Avaa kaikki",en:"Open all",sv:"Öppna alla"},close_all:{fi:"Sulje kaikki",en:"Close all",sv:"Stäng alla"}},u=C;var p=class p{constructor(e){t(this,"saveEventKey","localstorage-save-event");t(this,"loadOnChange",s(()=>{this.loadData()},"loadOnChange"));t(this,"triggerSaveEvent",s(()=>{dispatchEvent(new CustomEvent(this.saveEventKey))},"triggerSaveEvent"));t(this,"loadData",s(()=>{let e=null;try{e=localStorage.getItem(this.storageKey)}catch(i){p.handleError(i)}this.data=e?JSON.parse(e):{}},"loadData"));t(this,"saveData",s(()=>{try{localStorage.setItem(this.storageKey,JSON.stringify(this.data)),this.triggerSaveEvent()}catch(e){p.handleError(e)}},"saveData"));t(this,"setValue",s((e,i)=>{this.data[e]=i,this.saveData()},"setValue"));t(this,"addValue",s((e,i)=>{this.data[e]||(this.data[e]=[]),typeof i=="string"&&!this.data[e].includes(i)&&(this.data[e].push(i),this.saveData())},"addValue"));t(this,"getValue",s(e=>this.data[e]||null,"getValue"));t(this,"getValues",s(e=>this.data[e]||null,"getValues"));t(this,"removeValue",s((e,i)=>{if(this.data[e]){let o=this.data[e].indexOf(i);o>-1&&(this.data[e].splice(o,1),this.saveData())}},"removeValue"));this.data={},this.storageKey=e,this.loadData(),addEventListener(this.saveEventKey,this.loadOnChange)}static handleError(e){if(!(e instanceof ReferenceError))throw e}};s(p,"LocalStorageManager");var f=p;var m=class m{constructor(){t(this,"getStorageKey",s(()=>`${this.site}-accordion`,"getStorageKey"));t(this,"saveItemState",s((e,i)=>{if(!this.site)return!1;this.siteAccordionStates[this.page]||(this.siteAccordionStates[this.page]={}),i===!1?delete this.siteAccordionStates[this.page][e]:this.siteAccordionStates[this.page][e]=i,this.storageManager.setValue(this.getStorageKey(),JSON.stringify(this.siteAccordionStates))},"saveItemState"));t(this,"loadItemState",s(e=>this.AccordionsOpen?!0:this.site?!!this.pageAccordionStates[e]:!1,"loadItemState"));this.storageManager=new f("helfi-settings"),this.site=window.drupalSettings.helfi_instance_name||"",this.page=window.drupalSettings.path.currentPath,this.siteAccordionStates=JSON.parse(this.storageManager.getValue(this.getStorageKey()))||{},this.pageAccordionStates=this.siteAccordionStates[this.page]||{},this.AccordionsOpen=m.isCookieSet("helfi_accordions_open")}};s(m,"State"),t(m,"isCookieSet",s(e=>{let o=document.cookie.split("; ");for(let a=0;a<o.length;a++)if(o[a].split("=")[0]===e)return!0;return!1},"isCookieSet")),t(m,"getCurrentLanguage",s(()=>window.drupalSettings.path.currentLanguage,"getCurrentLanguage"));var h=m;var n=class n{constructor(e,i,o,a="default"){t(this,"initializeAccordion",s(()=>{let e=this.accordion.getElementsByClassName(c.accordionItemElement);this.isSingleItemAccordion=e.length===1,Array.from(e).forEach(i=>{this.accordionItems.push(new c(i,this.localState,this.urlHash,this.updateToggleButtonLabel))}),"onbeforematch"in document.body&&this.enableHiddenUntilFound()},"initializeAccordion"));t(this,"enableHiddenUntilFound",s(()=>{this.accordionItems.forEach(e=>{e.element.classList.add("accordion-item--hidden-until-found");let i=e.element.querySelector(".accordion-item__content");e.isOpen||(i.hidden="until-found"),e.element.addEventListener("beforematch",()=>{e.element.style.setProperty("--js-accordion-open-time","0s"),e.element.offsetHeight,e.open(),setTimeout(()=>{e.element.style.removeProperty("--js-accordion-open-time")},10)})})},"enableHiddenUntilFound"));t(this,"addEventListeners",s(()=>{if(n.isHeaderless(this.type)||this.isSingleItemAccordion)return;let e=this.accordion.getElementsByClassName(n.toggleAllElement)[0];e.addEventListener("mouseup",this.toggleItems),e.addEventListener("keypress",this.toggleItems)},"addEventListeners"));t(this,"addChildAccordion",s(e=>{this.childAccordion=e},"addChildAccordion"));t(this,"showToggleButton",s(()=>{n.isHeaderless(this.type)||this.isSingleItemAccordion?this.accordion.getElementsByClassName(n.toggleAllElement)[0]?.classList.add("is-hidden"):this.accordion.getElementsByClassName(n.toggleAllElement)[0]?.classList.remove("is-hidden")},"showToggleButton"));t(this,"updateToggleButtonLabel",s(()=>{let e=this.accordion.getElementsByClassName(n.toggleAllElement)[0];e&&(this.areAllItemsOpen()?e.querySelector("span").textContent=u.close_all?.[this.currentLanguage]??u.close_all.en:e.querySelector("span").textContent=u.open_all?.[this.currentLanguage]??u.open_all.en,this.toggleAllLabelUpdate())},"updateToggleButtonLabel"));t(this,"getAccordionItemById",s(e=>this.accordionItems.find(i=>i.id===e),"getAccordionItemById"));t(this,"toggleItems",s(()=>this.areAllItemsOpen()?this.closeAll():this.openAll(),"toggleItems"));t(this,"openAll",s(()=>{this.accordionItems.forEach(e=>e.open()),this.childAccordion?.openAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate()},"openAll"));t(this,"closeAll",s(()=>{this.accordionItems.forEach(i=>i.closeWithoutFocus()),this.childAccordion?.closeAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate(),this.accordion.getElementsByClassName(n.toggleAllElement)[0].focus()},"closeAll"));t(this,"toggleAllLabelUpdate",s(()=>{let e=this.accordion.getElementsByClassName(n.toggleAllElement)[0];e&&this.areAllItemsOpen()?(e.classList.remove(n.toggleAllClosed),e.classList.add(n.toggleAllOpen)):(e.classList.remove(n.toggleAllOpen),e.classList.add(n.toggleAllClosed))},"toggleAllLabelUpdate"));t(this,"areAllItemsOpen",s(()=>this.accordionItems?.every(e=>e.isOpen)&&this.areChildItemsOpen(),"areAllItemsOpen"));t(this,"areChildItemsOpen",s(()=>this.childAccordion?.areAllItemsOpen()??this.accordionItems?.every(e=>e.isOpen),"areChildItemsOpen"));t(this,"isHardcoded",s(()=>this.type==="hardcoded","isHardcoded"));this.type=a,this.isSingleItemAccordion=!1,this.currentLanguage=h.getCurrentLanguage(),this.accordion=e,this.localState=i,this.accordionItems=[],this.childAccordion=null,this.urlHash=o,this.initializeAccordion(o),this.addEventListeners(),this.showToggleButton(),this.updateToggleButtonLabel()}};s(n,"HelfiAccordion"),t(n,"accordionWrapper","component--accordion"),t(n,"toggleAllElement","js-accordion__button--toggle-all"),t(n,"toggleAllOpen","accordion__button--is-open"),t(n,"toggleAllClosed","accordion__button--is-closed"),t(n,"headerlessTypes",["headerless","hardcoded"]),t(n,"isHeaderless",s(e=>n.headerlessTypes.includes(e),"isHeaderless"));var g=n;var A=class A{constructor(){A.handleTableOfContentsHash()}};s(A,"Events"),t(A,"handleTableOfContentsHash",s(()=>{window.addEventListener("hashchange",()=>{let{hash:e}=window.location;if(!e||e.length<2)return;let i=!1;if(window.helfiAccordions.forEach(o=>{let a=o.getAccordionItemById(e.replace("#",""));a&&(i=!0,a.handleLinkAnchor(e))}),!i){let o=document.querySelector(`${e}`);if(!o)return;let a=o.closest(`.${c.accordionItemElement}`);a&&window.helfiAccordions.forEach(d=>{let S=a.querySelector(".helfi-accordion__header").id,y=d.getAccordionItemById(S);y&&y.handleLinkAnchor()})}})},"handleTableOfContentsHash"));var E=A;window.helfiAccordions=[];var w=new h,Z=new E,{hash:b}=window.location,I=s(r=>r.includes("component--no-header")?"headerless":r.includes("component--hardcoded")?"hardcoded":"default","getAccordionType"),k=s((r,e)=>{let i=document.querySelectorAll(`.${g.accordionWrapper}`);if(i.length>window.helfiAccordions.length)try{i.forEach((o,a)=>{let d=I(Array.from(o.classList)),S=g.isHeaderless(d),y=a===0&&d!=="hardcoded"?"default":d,v=new g(o,w,b,y);window.helfiAccordions.push(v),!v.isHardcoded(d)&&S&&a>0&&window.helfiAccordions[a-1].addChildAccordion(v)})}catch(o){console.error(o),e.disconnect()}},"callback"),B=document.body,T={attributes:!0,childList:!0,subtree:!0},N=new MutationObserver(k);N.observe(B,T);})();
