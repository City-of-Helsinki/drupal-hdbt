"use strict";(self.webpackChunkhdbt=self.webpackChunkhdbt||[]).push([[599],{1599:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var l=a(5893),s=a(3665),n=a(2827),r=a(3450);var i={LOCATION:"location",DATE:"date",END_DISABLED:"end_disabled",FREE:"is_free",REMOTE:"internet_based",RESULTS:"page"},c=a(8953);var o=function(){const e=(0,s.Dv)(r.lH),[t,a]=(0,s.KO)(r.mO),o=(0,s.b9)(r.c$),d=Drupal.t("If you want to search for remote events, select only the option 'Internet (remote events)'");return(0,l.jsx)("div",Object.assign({className:"hdbt-search__filter event-form__filter--location"},{children:(0,l.jsx)(n.S,{className:"hdbt-search__dropdown",clearButtonAriaLabel:Drupal.t("Clear selections",{},{context:"Event search: clear button aria label"}),helper:d,label:Drupal.t("Select a venue"),multiselect:!0,options:e,value:t,id:i.LOCATION,onChange:e=>{a(e),o({[c.Z.LOCATION]:e.map((e=>e.value)).join(",")})},placeholder:Drupal.t("All",{},{context:"React search: all available options"}),selectedItemRemoveButtonAriaLabel:Drupal.t("Remove item",{},{context:"React search: remove item aria label"}),theme:{"--focus-outline-color":"var(--hdbt-color-black)","--multiselect-checkbox-background-selected":"var(--hdbt-color-black)","--placeholder-color":"var(--hdbt-color-black)"}})}))},d=a(2946);var u=function({disabled:e}){return(0,l.jsx)(d.B,Object.assign({type:"submit",disabled:e,className:"hdbt-search__submit-button event-list__submit-button"},{children:Drupal.t("Search",{},{context:"React search"})}))},b=a(7294),v=a(7126),h=a(1310),m=a(7425);var j=(e,t)=>{(0,b.useEffect)((()=>{const a=a=>{e.current&&!e.current.contains(a.target)&&t()};return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}}))};var D=function({active:e,ariaControls:t,helper:a,id:s,label:n,title:r,children:i,showHandle:c}){const[o,d]=(0,b.useState)(e||!1),u=(0,b.useRef)(null);return j(u,(()=>{d(!1)})),(0,l.jsxs)("div",Object.assign({className:"collapsible-wrapper",ref:u},{children:[(0,l.jsx)("label",Object.assign({className:"collapsible__label",htmlFor:s},{children:n})),(0,l.jsxs)("button",Object.assign({id:s,type:"button",className:"collapsible__element collapsible__control","aria-controls":t,"aria-expanded":o,onClick:()=>d(!o)},{children:[(0,l.jsx)("span",Object.assign({className:"collapsible__title"},{children:r})),(()=>{if(!1!==c)return o?(0,l.jsx)(m.Z,{icon:"angle-up",className:"collapsible__handle",onClick:()=>d(!o)}):(0,l.jsx)(m.Z,{icon:"angle-down",className:"collapsible__handle",onClick:()=>d(!o)})})()]})),o&&(0,l.jsx)("div",Object.assign({className:"collapsible__element collapsible__children"},{children:i})),a&&(0,l.jsx)("div",Object.assign({"aria-hidden":!0,className:"collapsible__helper"},{children:a}))]}))},_=a(166);var p=function({id:e,label:t,atom:a,valueKey:n}){const[i,c]=(0,s.KO)(a),o=(0,s.b9)(r.l),d=(0,s.b9)(r.c$);return(0,l.jsx)(_.C,{checked:i||!1,className:"hdbt-search__filter hdbt-search__checkbox",id:e,label:t,onChange:e=>(e=>{var t;if(!(null===(t=null==e?void 0:e.target)||void 0===t?void 0:t.checked))return c(!1),void o(n);c(!0),d({[n]:"true"})})(e)})};var g="d.M.yyyy";var x=({startDate:e,endDate:t})=>e&&e.isValid||t&&t.isValid?!e||!e.isValid||t&&t.isValid?e&&e.isValid||!(null==t?void 0:t.isValid)?`${(null==e?void 0:e.toFormat(g))||"unset?"} - ${null==t?void 0:t.toFormat(g)}`:`- ${t.toFormat(g)}`:e.toFormat(g):Drupal.t("All",{},{context:""});const f=Drupal.t("Use the format D.M.YYYY"),O=e=>v.ou.fromFormat(e,g,{locale:"fi"}),N=({endDate:e,startDate:t})=>!!(t&&e&&t.startOf("day")>=e.startOf("day")),y=e=>!!e&&(e.year>9999||!e.isValid);var E=function(){const{currentLanguage:e}=drupalSettings.path,t=(0,s.Dv)(r.QP),[a,n]=(0,s.KO)(r.sC),[o,d]=(0,s.KO)(r.DB),[u,v]=(0,s.KO)(r.uA),m=(0,s.b9)(r.l),j=(0,s.b9)(r.c$),_=(e,t)=>{"start"===t?w(e):F(e)},E=x({startDate:a,endDate:o}),S=u.invalidStartDate?Drupal.t("Invalid start date"):"",C=u.invalidEndDate?Drupal.t("Invalid end date"):"",w=e=>{const t=O(e);y(t)?(console.warn("invalid start date",{start:t,endDate:o}),0===e.length?(n(void 0),v(Object.assign(Object.assign({},u),{invalidStartDate:!1}))):v(Object.assign(Object.assign({},u),{invalidStartDate:!0}))):(N({startDate:t,endDate:o})&&(console.warn("Selected start date is out of range with end date, setting end date to next day after start date."),d(null==t?void 0:t.plus({days:1}))),n(t),v(Object.assign(Object.assign({},u),{invalidStartDate:!1})))},F=e=>{const t=O(e);y(t)?(console.warn("invalid end date",{end:t,d:e}),0===e.length?(v(Object.assign(Object.assign({},u),{invalidEndDate:!1})),d(void 0)):v(Object.assign(Object.assign({},u),{invalidEndDate:!0}))):(N({startDate:a,endDate:t})?(console.warn("Selected end date is out of range, setting end date to next day after start date."),d(null==a?void 0:a.plus({days:1}))):d(t),v(Object.assign(Object.assign({},u),{invalidEndDate:!1})))};return(0,b.useEffect)((()=>{const e=(e,t)=>{t&&t.isValid?t.isValid?j({[e]:t.toISODate()}):console.warn("invalid date given to setDate",{date:t}):m(e)};e(c.Z.START,a),t&&(e(c.Z.END,a),d(a),v(Object.assign(Object.assign({},u),{invalidEndDate:!1}))),t||(e(c.Z.END,o),d(o),v(Object.assign(Object.assign({},u),{invalidEndDate:!1})))}),[a,o,t]),(0,l.jsx)("div",Object.assign({className:"hdbt-search__filter event-form__filter--date"},{children:(0,l.jsx)(D,Object.assign({id:"event-search__date-select",label:Drupal.t("Date",{},{context:"React search: date selection label"}),helper:Drupal.t("Select a time period in which in which the event takes place"),title:E},{children:(0,l.jsxs)("div",Object.assign({className:"event-form__date-container"},{children:[(0,l.jsx)(h.D,{className:"hdbt-search__filter hdbt-search__date-input",helperText:f,id:"start-date",label:Drupal.t("First day of the time period"),language:e,invalid:u.invalidStartDate,errorText:S,value:null==a?void 0:a.toFormat(g),onChange:e=>_(e,"start")}),(0,l.jsx)(p,{id:"end-disabled",label:Drupal.t("The last day of the time period is the same as the first day"),atom:r.QP,valueKey:i.END_DISABLED}),(0,l.jsx)(h.D,{minDate:t||null==a?void 0:a.plus({days:1}).toJSDate(),className:"hdbt-search__filter hdbt-search__date-input",disabled:t,helperText:f,id:"end-date",label:Drupal.t("Last day of the time period"),language:e,invalid:u.invalidEndDate,errorText:C,value:t?null==a?void 0:a.toFormat(g):null==o?void 0:o.toFormat(g),onChange:e=>_(e,"end")})]}))}))}))},S=a(5338);const C=({value:e,clearSelection:t})=>(0,l.jsx)("li",Object.assign({className:"content-tags__tags__tag content-tags__tags--interactive"},{children:(0,l.jsx)(d.B,Object.assign({"aria-label":Drupal.t("Remove @item from search results",{"@item":e.toString()},{context:"Search: remove item aria label"}),className:"hdbt-search__remove-selection-button",iconRight:(0,l.jsx)(S.I,{}),variant:"supplementary",onClick:t},{children:e}))}),`${e.toString()}`),w=(e,t)=>e.url===t.url,F=(0,b.memo)((({updater:e,values:t,valueKey:a,url:n})=>{const i=(0,s.b9)(r.c$),c=(0,s.b9)(r.T);if(!t.length)return null;return(0,l.jsx)(l.Fragment,{children:t.map((s=>(0,l.jsx)(C,{value:s.simpleLabel||s.label,clearSelection:()=>(l=>{const s=t,n=s.findIndex((e=>e.value===l));s.splice(n,1),e(s),i({[a]:s.map((e=>e.value)).join(",")}),c()})(s.value)},s.value)))})}),w),k=(0,b.memo)((({atom:e,valueKey:t,label:a,url:n,value:i})=>{const c=(0,s.b9)(e),o=(0,s.b9)(r.l),d=(0,s.b9)(r.T);return i?(0,l.jsx)(C,{value:a,clearSelection:()=>{c(!1),o(t),d()}}):null}),w),R=(0,b.memo)((({startDate:e,endDate:t,url:a})=>{const n=(0,s.b9)(r.sC),i=(0,s.b9)(r.DB),c=(0,s.b9)(r.l),o=(0,s.b9)(r.T);return e||t?(0,l.jsx)(C,{value:x({startDate:e,endDate:t}),clearSelection:()=>{n(void 0),i(void 0),c("start"),c("end"),o()}}):null}),w),T=(0,b.memo)((({showClearButton:e,url:t})=>{const a=(0,s.b9)(r.tH);return(0,l.jsx)("li",Object.assign({className:"hdbt-search__clear-all"},{children:(0,l.jsx)(d.B,Object.assign({"aria-hidden":e?"true":"false",className:"hdbt-search__clear-all-button",iconLeft:(0,l.jsx)(S.I,{className:"hdbt-search__clear-all-icon"}),onClick:()=>{a()},style:e?{}:{visibility:"hidden"},variant:"supplementary"},{children:Drupal.t("Clear selections",{},{context:"React search: clear selections"})}))}))}),w);var L=(0,b.memo)((({url:e})=>{const t=(0,s.Dv)(r.mH),a=(0,s.Dv)(r.GF),n=(0,s.Dv)(r.sC),i=(0,s.Dv)(r.DB),[o,d]=(0,s.KO)(r.mO),u=o.length||n||i||t||a;return e?(0,l.jsx)("div",Object.assign({className:"hdbt-search__selections-wrapper"},{children:(0,l.jsxs)("ul",Object.assign({className:"hdbt-search__selections-container content-tags__tags"},{children:[(0,l.jsx)(F,{updater:d,valueKey:c.Z.LOCATION,values:o,url:e}),(0,l.jsx)(R,{startDate:n,endDate:i,url:e}),(0,l.jsx)(k,{label:Drupal.t("Remote events"),valueKey:c.Z.REMOTE,atom:r.GF,url:e,value:a}),(0,l.jsx)(k,{label:Drupal.t("Free-of-charge events"),valueKey:c.Z.FREE,atom:r.mH,url:e,value:t}),(0,l.jsx)(T,{showClearButton:u,url:e})]}))})):null}),w);var I=function(){const e=(0,s.Dv)(r.nj),t=(0,s.Dv)(r.Ju),a=(0,s.Dv)(r.uA),n=(0,s.Dv)(r.aV),i=(0,s.b9)(r.T),{showLocation:d,showFreeFilter:b,showRemoteFilter:v,showTimeFilter:h}=e,m=b&&v,j=Drupal.t("Show only",{},{context:"Event search: event type prefix"}),D=Drupal.t("Free-of-charge events"),_=Drupal.t("Remote events"),g=m?D:`${j} ${D.toLowerCase()}`,x=m?_:`${j} ${_.toLowerCase()}`,f=t?"h3":"h2";return d||b||h||v?(0,l.jsxs)("form",Object.assign({className:"react-search__form-container",onSubmit:e=>(e.preventDefault(),i(),!1)},{children:[(0,l.jsx)(f,Object.assign({className:"event-list__filter-title"},{children:Drupal.t("Filter events",{},{context:"Event search: search form title"})})),(0,l.jsxs)("div",Object.assign({className:"event-form__filters-container"},{children:[(0,l.jsxs)("div",Object.assign({className:"event-form__filter-section-container"},{children:[d&&(0,l.jsx)(o,{}),h&&(0,l.jsx)(E,{})]})),m&&(0,l.jsx)("div",Object.assign({className:"event-form__checkboxes-label"},{children:j})),(0,l.jsxs)("div",Object.assign({className:"event-form__filter-checkbox-container"},{children:[v&&(0,l.jsx)(p,{id:"remote-toggle",label:x,atom:r.GF,valueKey:c.Z.REMOTE}),b&&(0,l.jsx)(p,{id:"free-toggle",label:g,atom:r.mH,valueKey:c.Z.FREE})]})),(0,l.jsx)(u,{disabled:a.invalidEndDate||a.invalidStartDate}),(0,l.jsx)(L,{url:n})]}))]})):null}}}]);