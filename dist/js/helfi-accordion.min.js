"use strict";(()=>{var p=Object.defineProperty;var u=(l,e,s)=>e in l?p(l,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[e]=s;var t=(l,e,s)=>u(l,typeof e!="symbol"?e+"":e,s);var n=class n{constructor(e,s,a,o){t(this,"open",()=>{this._isOpen=!0,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"close",()=>{this._isOpen=!1,this.setAriaOpen(),this.changeFocus(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"closeWithoutFocus",()=>{this._isOpen=!1,this.setAriaOpen(),this.setHidden(),this.parentCallback(),this.localState.saveItemState(this.id,this.isOpen)});t(this,"toggle",e=>{n.isClick(e.which)&&(this.isOpen?this.close():this.open())});t(this,"handleLinkAnchor",e=>{if(!e||e.length===0)return;let s=this.element.querySelector(e);s&&(this.open(),s.scrollIntoView())});t(this,"setAriaOpen",()=>{n.ariaExpandedElements.forEach(e=>{this.element.getElementsByClassName(e)[0].setAttribute("aria-expanded",this.isOpen)})});t(this,"setHidden",e=>{let s=this.element.closest(".accordion"),a=this.element.getElementsByClassName(n.contentElement)[0];if(e){s.style.setProperty("--js-accordion-open-time","0s"),document.body.offsetHeight,this.isOpen?a.removeAttribute("hidden"):a.hidden="until-found",setTimeout(()=>{s.style.removeProperty("--js-accordion-open-time")},10);return}if(this.isOpen)a.removeAttribute("hidden");else{let o=parseInt(getComputedStyle(s).getPropertyValue("--js-accordion-open-time"),10)||200;setTimeout(()=>{a.hidden="until-found"},o)}});t(this,"changeFocus",()=>this.element.querySelector(`.${n.toggleElement}`).focus());t(this,"addEventListeners",()=>{let e=this.element.getElementsByClassName(n.toggleElement)[0];e.addEventListener("mouseup",this.toggle),e.addEventListener("keypress",this.toggle);let s=this.element.getElementsByClassName(n.closeElement),a=s[s.length-1];a.addEventListener("mouseup",this.close),a.addEventListener("keypress",this.close)});this.element=e,this.localState=s,this.parentCallback=o,this._id=e.dataset.accordionId,this._isOpen=this.localState.loadItemState(this._id),this.setHidden(!0),this.addEventListeners(),this.handleLinkAnchor(a),this.setAriaOpen()}static isClick(e){return e===1||e===13||e===32}get id(){return this._id}get isOpen(){return this._isOpen}};t(n,"accordionItemElement","helfi-accordion-item"),t(n,"toggleElement","accordion-item__button--toggle"),t(n,"closeElement","accordion-item__button--close"),t(n,"ariaExpandedElements",["accordion-item__button--toggle"]),t(n,"contentElement","accordion-item__content");var r=n;var E={open_all:{fi:"Avaa kaikki",en:"Open all",sv:"Öppna alla"},close_all:{fi:"Sulje kaikki",en:"Close all",sv:"Stäng alla"}},c=E;var d=class l{constructor(e){t(this,"saveEventKey","localstorage-save-event");t(this,"loadOnChange",()=>{this.loadData()});t(this,"triggerSaveEvent",()=>{dispatchEvent(new CustomEvent(this.saveEventKey))});t(this,"loadData",()=>{let e=null;try{e=localStorage.getItem(this.storageKey)}catch(s){l.handleError(s)}this.data=e?JSON.parse(e):{}});t(this,"saveData",()=>{try{localStorage.setItem(this.storageKey,JSON.stringify(this.data)),this.triggerSaveEvent()}catch(e){l.handleError(e)}});t(this,"setValue",(e,s)=>{this.data[e]=s,this.saveData()});t(this,"addValue",(e,s)=>{this.data[e]||(this.data[e]=[]),typeof s=="string"&&!this.data[e].includes(s)&&(this.data[e].push(s),this.saveData())});t(this,"getValue",e=>this.data[e]||null);t(this,"getValues",e=>this.data[e]||null);t(this,"removeValue",(e,s)=>{if(this.data[e]){let a=this.data[e].indexOf(s);a>-1&&(this.data[e].splice(a,1),this.saveData())}});this.data={},this.storageKey=e,this.loadData(),addEventListener(this.saveEventKey,this.loadOnChange)}static handleError(e){if(!(e instanceof ReferenceError))throw e}};var h=class h{constructor(){t(this,"getStorageKey",()=>`${this.site}-accordion`);t(this,"saveItemState",(e,s)=>{if(!this.site)return!1;this.siteAccordionStates[this.page]||(this.siteAccordionStates[this.page]={}),s===!1?delete this.siteAccordionStates[this.page][e]:this.siteAccordionStates[this.page][e]=s,this.storageManager.setValue(this.getStorageKey(),JSON.stringify(this.siteAccordionStates))});t(this,"loadItemState",e=>this.AccordionsOpen?!0:this.site?!!this.pageAccordionStates[e]:!1);this.storageManager=new d("helfi-settings"),this.site=window.drupalSettings.helfi_instance_name||"",this.page=window.drupalSettings.path.currentPath,this.siteAccordionStates=JSON.parse(this.storageManager.getValue(this.getStorageKey()))||{},this.pageAccordionStates=this.siteAccordionStates[this.page]||{},this.AccordionsOpen=h.isCookieSet("helfi_accordions_open")}};t(h,"isCookieSet",e=>{let a=document.cookie.split("; ");for(let o=0;o<a.length;o++)if(a[o].split("=")[0]===e)return!0;return!1}),t(h,"getCurrentLanguage",()=>window.drupalSettings.path.currentLanguage);var g=h;var i=class i{constructor(e,s,a,o="default"){t(this,"initializeAccordion",()=>{let e=this.accordion.getElementsByClassName(r.accordionItemElement);this.isSingleItemAccordion=e.length===1,Array.from(e).forEach(s=>{this.accordionItems.push(new r(s,this.localState,this.urlHash,this.updateToggleButtonLabel))}),"onbeforematch"in document.body&&this.enableHiddenUntilFound()});t(this,"enableHiddenUntilFound",()=>{this.accordionItems.forEach(e=>{e.element.classList.add("accordion-item--hidden-until-found");let s=e.element.querySelector(".accordion-item__content");e.isOpen||(s.hidden="until-found"),e.element.addEventListener("beforematch",()=>{e.element.style.setProperty("--js-accordion-open-time","0s"),e.element.offsetHeight,e.open(),setTimeout(()=>{e.element.style.removeProperty("--js-accordion-open-time")},10)})})});t(this,"addEventListeners",()=>{if(i.isHeaderless(this.type)||this.isSingleItemAccordion)return;let e=this.accordion.getElementsByClassName(i.toggleAllElement)[0];e.addEventListener("mouseup",this.toggleItems),e.addEventListener("keypress",this.toggleItems)});t(this,"addChildAccordion",e=>{this.childAccordion=e});t(this,"showToggleButton",()=>{i.isHeaderless(this.type)||this.isSingleItemAccordion?this.accordion.getElementsByClassName(i.toggleAllElement)[0]?.classList.add("is-hidden"):this.accordion.getElementsByClassName(i.toggleAllElement)[0]?.classList.remove("is-hidden")});t(this,"updateToggleButtonLabel",()=>{let e=this.accordion.getElementsByClassName(i.toggleAllElement)[0];e&&(this.areAllItemsOpen()?e.querySelector("span").textContent=c.close_all?.[this.currentLanguage]??c.close_all.en:e.querySelector("span").textContent=c.open_all?.[this.currentLanguage]??c.open_all.en,this.toggleAllLabelUpdate())});t(this,"getAccordionItemById",e=>this.accordionItems.find(s=>s.id===e));t(this,"toggleItems",()=>this.areAllItemsOpen()?this.closeAll():this.openAll());t(this,"openAll",()=>{this.accordionItems.forEach(e=>e.open()),this.childAccordion?.openAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate()});t(this,"closeAll",()=>{this.accordionItems.forEach(s=>s.closeWithoutFocus()),this.childAccordion?.closeAll(),this.updateToggleButtonLabel(),this.toggleAllLabelUpdate(),this.accordion.getElementsByClassName(i.toggleAllElement)[0].focus()});t(this,"toggleAllLabelUpdate",()=>{let e=this.accordion.getElementsByClassName(i.toggleAllElement)[0];e&&this.areAllItemsOpen()?(e.classList.remove(i.toggleAllClosed),e.classList.add(i.toggleAllOpen)):(e.classList.remove(i.toggleAllOpen),e.classList.add(i.toggleAllClosed))});t(this,"areAllItemsOpen",()=>this.accordionItems?.every(e=>e.isOpen)&&this.areChildItemsOpen());t(this,"areChildItemsOpen",()=>this.childAccordion?.areAllItemsOpen()??this.accordionItems?.every(e=>e.isOpen));t(this,"isHardcoded",()=>this.type==="hardcoded");this.type=o,this.isSingleItemAccordion=!1,this.currentLanguage=g.getCurrentLanguage(),this.accordion=e,this.localState=s,this.accordionItems=[],this.childAccordion=null,this.urlHash=a,this.initializeAccordion(a),this.addEventListeners(),this.showToggleButton(),this.updateToggleButtonLabel()}};t(i,"accordionWrapper","component--accordion"),t(i,"toggleAllElement","js-accordion__button--toggle-all"),t(i,"toggleAllOpen","accordion__button--is-open"),t(i,"toggleAllClosed","accordion__button--is-closed"),t(i,"headerlessTypes",["headerless","hardcoded"]),t(i,"isHeaderless",e=>i.headerlessTypes.includes(e));var m=i;})();
