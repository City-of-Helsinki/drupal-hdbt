(()=>{var e=Object.defineProperty;var t=(t,a,i)=>a in t?e(t,a,{enumerable:true,configurable:true,writable:true,value:i}):t[a]=i;var a=(t,a)=>e(t,"name",{value:a,configurable:true});var i=(e,a,i)=>t(e,typeof a!=="symbol"?a+"":a,i);var n={isCookieSet:a(e=>{const t=document.cookie;const a=t.split("; ");for(let t=0;t<a.length;t++){const i=a[t].split("=");if(i[0]===e){return true}}return false},"isCookieSet"),getCurrentLanguage:a(()=>window.drupalSettings.path.currentLanguage,"getCurrentLanguage")};var o=n;var s=class e{constructor(t){i(this,"saveEventKey","localstorage-save-event");i(this,"loadOnChange",a(()=>{this.loadData()},"loadOnChange"));i(this,"triggerSaveEvent",a(()=>{dispatchEvent(new CustomEvent(this.saveEventKey))},"triggerSaveEvent"));i(this,"loadData",a(()=>{let t=null;try{const e=globalThis?.localStorage;if(!e){this.data={};return}t=e.getItem(this.storageKey)}catch(t){e.handleError(t)}this.data=t?JSON.parse(t):{}},"loadData"));i(this,"saveData",a(()=>{try{const e=globalThis?.localStorage;if(!e)return;e.setItem(this.storageKey,JSON.stringify(this.data));this.triggerSaveEvent()}catch(t){e.handleError(t)}},"saveData"));i(this,"setValue",a((e,t)=>{this.data[e]=t;this.saveData()},"setValue"));i(this,"addValue",a((e,t)=>{if(!this.data[e]){this.data[e]=[]}if(typeof t==="string"&&!this.data[e].includes(t)){this.data[e].push(t);this.saveData()}},"addValue"));i(this,"getValue",a(e=>this.data[e]||null,"getValue"));i(this,"getValues",a(e=>this.data[e]||null,"getValues"));i(this,"removeValue",a((e,t)=>{if(this.data[e]){const a=this.data[e].indexOf(t);if(a>-1){this.data[e].splice(a,1);this.saveData()}}},"removeValue"));this.data={};this.storageKey=t;this.loadData();addEventListener(this.saveEventKey,this.loadOnChange)}static handleError(e){if(e instanceof ReferenceError){}else{throw e}}};a(s,"LocalStorageManager");var r=s;(Drupal=>{Drupal.behaviors.closableSurveys={attach:a(function e(t){if(t!==document||window.closableSurveysInitialized){return}const i=document.getElementById("block-surveys");const n=document.getElementById("dialog-off-canvas-main-canvas");if(i){if(n){n.parentNode.insertBefore(i,n.nextSibling)}else{document.body.insertBefore(i,document.body.lastChild)}}const s=document.getElementById("helfi-survey__container");if(!s)return;const l=document.documentElement;const c=2e3;const u=document.querySelectorAll(".dialog__actions .dialog__action-button");const d="hidden-helfi-surveys";const h=new r("helfi-settings");let g=null;const f=o.isCookieSet("helfi_no_survey");function v(){const{uuid:e}=s.dataset;if(e){h.addValue(d,e)}}a(v,"addToSurveyStorage");function y(){g=window.focusTrap.createFocusTrap("#helfi-survey",{initialFocus:a(()=>"#helfi-survey__title","initialFocus")});g.activate()}a(y,"addFocusTrap");function m(e){l.classList.toggle("noscroll",e)}a(m,"toggleNoScroll");function b(e){if(e){document.body.style.paddingRight=`${window.innerWidth-document.documentElement.clientWidth}px`}else{document.body.style.removeProperty("padding-right")}}a(b,"setBodyPaddingRight");function S(){const e=document.querySelector(".hds-cc__target");const t=e?.shadowRoot;const a=t?.querySelector(".hds-cc__all-cookies-button");if(e&&a){a.focus()}}a(S,"focusToCookieBanner");function p(){const e=document.querySelector(".dialog-off-canvas-main-canvas");const t=document.querySelector(".hds-cc__target");const a=document.querySelector(".skip-link--skip-to-main");const i=document.getElementById("helfi-survey__container");if(e&&!e.hasAttribute("inert")&&i){e.setAttribute("inert","")}else{e?.removeAttribute("inert")}if(a&&!a.hasAttribute("inert")&&i){a.setAttribute("inert","")}else{a?.removeAttribute("inert")}if(t&&!t.hasAttribute("inert")&&i){t.setAttribute("inert","")}else{t?.removeAttribute("inert")}}a(p,"toggleOtherContentVisibility");function E(){const{uuid:e}=s.dataset;const t=h.getValue(d)||[];const a=!e||!t.includes(e);if(a){s.style.display="flex";b(true);m(true);y();p()}else{s.remove();p();S()}}a(E,"showSurvey");function _(){v();g.deactivate();s.remove();m(false);b(false);p();S()}a(_,"removeSurvey");if(u){u.forEach(e=>{e.addEventListener("click",_)})}function w(e){if(e.key==="Escape"){_()}}a(w,"handleEscapeKey");document.body.addEventListener("keydown",w);if(!f){setTimeout(E,c)}window.closableSurveysInitialized=true},"attach")}})(Drupal)})();