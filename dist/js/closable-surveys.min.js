!function(){"use strict";class t{saveEventKey="localstorage-save-event";constructor(t){this.data={},this.storageKey=t,this.loadData(),addEventListener(this.saveEventKey,this.loadOnChange)}loadOnChange=()=>{this.loadData()};triggerSaveEvent=()=>{dispatchEvent(new CustomEvent(this.saveEventKey))};loadData=()=>{let e=null;try{e=localStorage.getItem(this.storageKey)}catch(e){t.handleError(e)}this.data=e?JSON.parse(e):{}};saveData=()=>{try{localStorage.setItem(this.storageKey,JSON.stringify(this.data)),this.triggerSaveEvent()}catch(e){t.handleError(e)}};setValue=(t,e)=>{this.data[t]=e,this.saveData()};addValue=(t,e)=>{this.data[t]||(this.data[t]=[]),"string"!=typeof e||this.data[t].includes(e)||(this.data[t].push(e),this.saveData())};getValue=t=>this.data[t]||null;getValues=t=>this.data[t]||null;removeValue=(t,e)=>{if(this.data[t]){const a=this.data[t].indexOf(e);a>-1&&(this.data[t].splice(a,1),this.saveData())}};static handleError(t){if(!(t instanceof ReferenceError))throw t}}(Drupal=>{Drupal.behaviors.closable_surveys={attach:function(){const e=document.getElementById("block-surveys"),a=document.getElementById("skip-to-main");e&&(a?a.parentNode.insertBefore(e,a.nextSibling):document.body.insertBefore(e,document.body.firstChild));const n=document.getElementById("helfi-survey__container");if(!n)return;const i=document.documentElement,o=document.querySelectorAll(".dialog__actions .dialog__action-button"),s="hidden-helfi-surveys",r=new t("helfi-settings");let c=null,d=null;try{c=JSON.parse(window.localStorage.getItem("helfi-settings"))}catch(t){console.error("Error parsing local storage data:",t)}function l(t){i.classList.toggle("noscroll",t)}function u(t){t?document.body.style.paddingRight=window.innerWidth-document.documentElement.clientWidth+"px":document.body.style.removeProperty("padding-right")}function h(){const t=document.querySelector(".hds-cc__target"),e=t?.shadowRoot,a=e?.querySelector(".hds-cc__all-cookies-button");t&&a&&a.focus()}function v(){const t=document.querySelector(".dialog-off-canvas-main-canvas"),e=document.querySelector(".hds-cc__target"),a=document.querySelector(".skip-link--skip-to-main"),n=document.getElementById("helfi-survey__container");t&&!t.hasAttribute("inert")&&n?t.setAttribute("inert",""):t&&t.removeAttribute("inert"),a&&!a.hasAttribute("inert")&&n?a.setAttribute("inert",""):a&&a.removeAttribute("inert"),e&&!e.hasAttribute("inert")&&n?e.setAttribute("inert",""):e&&e.removeAttribute("inert")}function y(){!function(){const{uuid:t}=n.dataset;t&&r.addValue(s,t)}(),d.deactivate(),n.remove(),l(!1),u(!1),v(),h()}o&&o.forEach((t=>t.addEventListener("click",y))),document.body.addEventListener("keydown",(function(t){"Escape"===t.key&&y()})),setTimeout((function(){const{uuid:t}=n.dataset;!t||!(c?.[s]||[]).includes(t)?(n.style.display="flex",u(!0),l(!0),d=window.focusTrap.createFocusTrap("#helfi-survey",{initialFocus:()=>"#helfi-survey__title"}),d.activate(),v()):(n.remove(),v(),h())}),2e3)}}})(Drupal)}();