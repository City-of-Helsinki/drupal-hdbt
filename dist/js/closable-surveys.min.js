(()=>{var e=Object.defineProperty;var t=(t,a,i)=>a in t?e(t,a,{enumerable:true,configurable:true,writable:true,value:i}):t[a]=i;var a=(t,a)=>e(t,"name",{value:a,configurable:true});var i=(e,a,i)=>t(e,typeof a!=="symbol"?a+"":a,i);var n=class e{constructor(t){i(this,"saveEventKey","localstorage-save-event");i(this,"loadOnChange",a(()=>{this.loadData()},"loadOnChange"));i(this,"triggerSaveEvent",a(()=>{dispatchEvent(new CustomEvent(this.saveEventKey))},"triggerSaveEvent"));i(this,"loadData",a(()=>{let t=null;try{t=localStorage.getItem(this.storageKey)}catch(t){e.handleError(t)}this.data=t?JSON.parse(t):{}},"loadData"));i(this,"saveData",a(()=>{try{localStorage.setItem(this.storageKey,JSON.stringify(this.data));this.triggerSaveEvent()}catch(t){e.handleError(t)}},"saveData"));i(this,"setValue",a((e,t)=>{this.data[e]=t;this.saveData()},"setValue"));i(this,"addValue",a((e,t)=>{if(!this.data[e]){this.data[e]=[]}if(typeof t==="string"&&!this.data[e].includes(t)){this.data[e].push(t);this.saveData()}},"addValue"));i(this,"getValue",a(e=>this.data[e]||null,"getValue"));i(this,"getValues",a(e=>this.data[e]||null,"getValues"));i(this,"removeValue",a((e,t)=>{if(this.data[e]){const a=this.data[e].indexOf(t);if(a>-1){this.data[e].splice(a,1);this.saveData()}}},"removeValue"));this.data={};this.storageKey=t;this.loadData();addEventListener(this.saveEventKey,this.loadOnChange)}static handleError(e){if(e instanceof ReferenceError){}else{throw e}}};a(n,"LocalStorageManager");var s=n;(Drupal=>{Drupal.behaviors.closable_surveys={attach:a(function e(){const t=document.getElementById("block-surveys");const i=document.getElementById("skip-to-main");if(t){if(i){i.parentNode.insertBefore(t,i.nextSibling)}else{document.body.insertBefore(t,document.body.firstChild)}}const n=document.getElementById("helfi-survey__container");if(!n)return;const o=document.documentElement;const r=2e3;const l=document.querySelectorAll(".dialog__actions .dialog__action-button");const c="hidden-helfi-surveys";const d=new s("helfi-settings");let u=null;let h=null;try{u=JSON.parse(window.localStorage.getItem("helfi-settings"))}catch(e){console.error("Error parsing local storage data:",e)}function v(){const{uuid:e}=n.dataset;if(e){d.addValue(c,e)}}a(v,"addToSurveyStorage");function f(){h=window.focusTrap.createFocusTrap("#helfi-survey",{initialFocus:a(()=>"#helfi-survey__title","initialFocus")});h.activate()}a(f,"addFocusTrap");function g(e){o.classList.toggle("noscroll",e)}a(g,"toggleNoScroll");function y(e){if(e){document.body.style.paddingRight=`${window.innerWidth-document.documentElement.clientWidth}px`}else{document.body.style.removeProperty("padding-right")}}a(y,"setBodyPaddingRight");function m(){const e=document.querySelector(".hds-cc__target");const t=e?.shadowRoot;const a=t?.querySelector(".hds-cc__all-cookies-button");if(e&&a){a.focus()}}a(m,"focusToCookieBanner");function b(){const e=document.querySelector(".dialog-off-canvas-main-canvas");const t=document.querySelector(".hds-cc__target");const a=document.querySelector(".skip-link--skip-to-main");const i=document.getElementById("helfi-survey__container");if(e&&!e.hasAttribute("inert")&&i){e.setAttribute("inert","")}else{e&&e.removeAttribute("inert")}if(a&&!a.hasAttribute("inert")&&i){a.setAttribute("inert","")}else{a&&a.removeAttribute("inert")}if(t&&!t.hasAttribute("inert")&&i){t.setAttribute("inert","")}else{t&&t.removeAttribute("inert")}}a(b,"toggleOtherContentVisibility");function E(){const{uuid:e}=n.dataset;const t=u?.[c]||[];const a=!e||!t.includes(e);if(a){n.style.display="flex";y(true);g(true);f();b()}else{n.remove();b();m()}}a(E,"showSurvey");function p(){v();h.deactivate();n.remove();g(false);y(false);b();m()}a(p,"removeSurvey");if(l){l.forEach(e=>e.addEventListener("click",p))}function S(e){if(e.key==="Escape"){p()}}a(S,"handleEscapeKey");document.body.addEventListener("keydown",S);setTimeout(E,r)},"attach")}})(Drupal)})();