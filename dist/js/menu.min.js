(()=>{var e=Object.create;var t=Object.defineProperty;var n=Object.getOwnPropertyDescriptor;var r=Object.getOwnPropertyNames;var a=Object.getPrototypeOf;var i=Object.prototype.hasOwnProperty;var s=(e,n)=>t(e,"name",{value:n,configurable:true});var o=(e,t)=>function n(){return t||(0,e[r(e)[0]])((t={exports:{}}).exports,t),t.exports};var l=(e,a,s,o)=>{if(a&&typeof a==="object"||typeof a==="function"){for(let l of r(a))if(!i.call(e,l)&&l!==s)t(e,l,{get:()=>a[l],enumerable:!(o=n(a,l))||o.enumerable})}return e};var u=(n,r,i)=>(i=n!=null?e(a(n)):{},l(r||!n||!n.__esModule?t(i,"default",{value:n,enumerable:true}):i,n));var c=o({"node_modules/classnames/index.js"(e,t){(function(){var e={}.hasOwnProperty;function n(){var t=[];for(var r=0;r<arguments.length;r++){var a=arguments[r];if(!a)continue;var i=typeof a;if(i==="string"||i==="number"){t.push(a)}else if(Array.isArray(a)){if(a.length){var s=n.apply(null,a);if(s){t.push(s)}}}else if(i==="object"){if(a.toString===Object.prototype.toString){for(var o in a){if(e.call(a,o)&&a[o]){t.push(o)}}}else{t.push(a.toString())}}}return t.join(" ")}s(n,"classNames");if(typeof t!=="undefined"&&t.exports){n.default=n;t.exports=n}else if(typeof define==="function"&&typeof define.amd==="object"&&define.amd){define("classnames",[],function(){return n})}else{window.classNames=n}})()}});var h=u(c());var p=Object.prototype.toString;var d=Array.isArray||s(function e(t){return p.call(t)==="[object Array]"},"isArrayPolyfill");function f(e){return typeof e==="function"}s(f,"isFunction");function m(e){return d(e)?"array":typeof e}s(m,"typeStr");function v(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}s(v,"escapeRegExp");function g(e,t){return e!=null&&typeof e==="object"&&t in e}s(g,"hasProperty");function b(e,t){return e!=null&&typeof e!=="object"&&e.hasOwnProperty&&e.hasOwnProperty(t)}s(b,"primitiveHasOwnProperty");var w=RegExp.prototype.test;function _(e,t){return w.call(e,t)}s(_,"testRegExp");var x=/\S/;function y(e){return!_(x,e)}s(y,"isWhitespace");var k={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};function I(e){return String(e).replace(/[&<>"'`=\/]/g,s(function e(t){return k[t]},"fromEntityMap"))}s(I,"escapeHtml");var P=/\s*/;var L=/\s+/;var E=/\s*=/;var j=/\s*\}/;var C=/#|\^|\/|>|\{|&|=|!/;function A(e,t){if(!e)return[];var n=false;var r=[];var a=[];var i=[];var o=false;var l=false;var u="";var c=0;function h(){if(o&&!l){while(i.length)delete a[i.pop()]}else{i=[]}o=false;l=false}s(h,"stripSpace");var p,f,m;function g(e){if(typeof e==="string")e=e.split(L,2);if(!d(e)||e.length!==2)throw new Error("Invalid tags: "+e);p=new RegExp(v(e[0])+"\\s*");f=new RegExp("\\s*"+v(e[1]));m=new RegExp("\\s*"+v("}"+e[1]))}s(g,"compileTags");g(t||B.tags);var b=new T(e);var w,_,x,k,I,A;while(!b.eos()){w=b.pos;x=b.scanUntil(p);if(x){for(var R=0,U=x.length;R<U;++R){k=x.charAt(R);if(y(k)){i.push(a.length);u+=k}else{l=true;n=true;u+=" "}a.push(["text",k,w,w+1]);w+=1;if(k==="\n"){h();u="";c=0;n=false}}}if(!b.scan(p))break;o=true;_=b.scan(C)||"name";b.scan(P);if(_==="="){x=b.scanUntil(E);b.scan(E);b.scanUntil(f)}else if(_==="{"){x=b.scanUntil(m);b.scan(j);b.scanUntil(f);_="&"}else{x=b.scanUntil(f)}if(!b.scan(f))throw new Error("Unclosed tag at "+b.pos);if(_==">"){I=[_,x,w,b.pos,u,c,n]}else{I=[_,x,w,b.pos]}c++;a.push(I);if(_==="#"||_==="^"){r.push(I)}else if(_==="/"){A=r.pop();if(!A)throw new Error('Unopened section "'+x+'" at '+w);if(A[1]!==x)throw new Error('Unclosed section "'+A[1]+'" at '+w)}else if(_==="name"||_==="{"||_==="&"){l=true}else if(_==="="){g(x)}}h();A=r.pop();if(A)throw new Error('Unclosed section "'+A[1]+'" at '+b.pos);return S(O(a))}s(A,"parseTemplate");function O(e){var t=[];var n,r;for(var a=0,i=e.length;a<i;++a){n=e[a];if(n){if(n[0]==="text"&&r&&r[0]==="text"){r[1]+=n[1];r[3]=n[3]}else{t.push(n);r=n}}}return t}s(O,"squashTokens");function S(e){var t=[];var n=t;var r=[];var a,i;for(var s=0,o=e.length;s<o;++s){a=e[s];switch(a[0]){case"#":case"^":n.push(a);r.push(a);n=a[4]=[];break;case"/":i=r.pop();i[5]=a[2];n=r.length>0?r[r.length-1][4]:t;break;default:n.push(a)}}return t}s(S,"nestTokens");function T(e){this.string=e;this.tail=e;this.pos=0}s(T,"Scanner");T.prototype.eos=s(function e(){return this.tail===""},"eos");T.prototype.scan=s(function e(t){var n=this.tail.match(t);if(!n||n.index!==0)return"";var r=n[0];this.tail=this.tail.substring(r.length);this.pos+=r.length;return r},"scan");T.prototype.scanUntil=s(function e(t){var n=this.tail.search(t),r;switch(n){case-1:r=this.tail;this.tail="";break;case 0:r="";break;default:r=this.tail.substring(0,n);this.tail=this.tail.substring(n)}this.pos+=r.length;return r},"scanUntil");function R(e,t){this.view=e;this.cache={".":this.view};this.parent=t}s(R,"Context");R.prototype.push=s(function e(t){return new R(t,this)},"push");R.prototype.lookup=s(function e(t){var n=this.cache;var r;if(n.hasOwnProperty(t)){r=n[t]}else{var a=this,i,s,o,l=false;while(a){if(t.indexOf(".")>0){i=a.view;s=t.split(".");o=0;while(i!=null&&o<s.length){if(o===s.length-1)l=g(i,s[o])||b(i,s[o]);i=i[s[o++]]}}else{i=a.view[t];l=g(a.view,t)}if(l){r=i;break}a=a.parent}n[t]=r}if(f(r))r=r.call(this.view);return r},"lookup");function U(){this.templateCache={_cache:{},set:s(function e(t,n){this._cache[t]=n},"set"),get:s(function e(t){return this._cache[t]},"get"),clear:s(function e(){this._cache={}},"clear")}}s(U,"Writer");U.prototype.clearCache=s(function e(){if(typeof this.templateCache!=="undefined"){this.templateCache.clear()}},"clearCache");U.prototype.parse=s(function e(t,n){var r=this.templateCache;var a=t+":"+(n||B.tags).join(":");var i=typeof r!=="undefined";var s=i?r.get(a):void 0;if(s==void 0){s=A(t,n);i&&r.set(a,s)}return s},"parse");U.prototype.render=s(function e(t,n,r,a){var i=this.getConfigTags(a);var s=this.parse(t,i);var o=n instanceof R?n:new R(n,void 0);return this.renderTokens(s,o,r,t,a)},"render");U.prototype.renderTokens=s(function e(t,n,r,a,i){var s="";var o,l,u;for(var c=0,h=t.length;c<h;++c){u=void 0;o=t[c];l=o[0];if(l==="#")u=this.renderSection(o,n,r,a,i);else if(l==="^")u=this.renderInverted(o,n,r,a,i);else if(l===">")u=this.renderPartial(o,n,r,i);else if(l==="&")u=this.unescapedValue(o,n);else if(l==="name")u=this.escapedValue(o,n,i);else if(l==="text")u=this.rawValue(o);if(u!==void 0)s+=u}return s},"renderTokens");U.prototype.renderSection=s(function e(t,n,r,a,i){var o=this;var l="";var u=n.lookup(t[1]);function c(e){return o.render(e,n,r,i)}s(c,"subRender");if(!u)return;if(d(u)){for(var h=0,p=u.length;h<p;++h){l+=this.renderTokens(t[4],n.push(u[h]),r,a,i)}}else if(typeof u==="object"||typeof u==="string"||typeof u==="number"){l+=this.renderTokens(t[4],n.push(u),r,a,i)}else if(f(u)){if(typeof a!=="string")throw new Error("Cannot use higher-order sections without the original template");u=u.call(n.view,a.slice(t[3],t[5]),c);if(u!=null)l+=u}else{l+=this.renderTokens(t[4],n,r,a,i)}return l},"renderSection");U.prototype.renderInverted=s(function e(t,n,r,a,i){var s=n.lookup(t[1]);if(!s||d(s)&&s.length===0)return this.renderTokens(t[4],n,r,a,i)},"renderInverted");U.prototype.indentPartial=s(function e(t,n,r){var a=n.replace(/[^ \t]/g,"");var i=t.split("\n");for(var s=0;s<i.length;s++){if(i[s].length&&(s>0||!r)){i[s]=a+i[s]}}return i.join("\n")},"indentPartial");U.prototype.renderPartial=s(function e(t,n,r,a){if(!r)return;var i=this.getConfigTags(a);var s=f(r)?r(t[1]):r[t[1]];if(s!=null){var o=t[6];var l=t[5];var u=t[4];var c=s;if(l==0&&u){c=this.indentPartial(s,u,o)}var h=this.parse(c,i);return this.renderTokens(h,n,r,c,a)}},"renderPartial");U.prototype.unescapedValue=s(function e(t,n){var r=n.lookup(t[1]);if(r!=null)return r},"unescapedValue");U.prototype.escapedValue=s(function e(t,n,r){var a=this.getConfigEscape(r)||B.escape;var i=n.lookup(t[1]);if(i!=null)return typeof i==="number"&&a===B.escape?String(i):a(i)},"escapedValue");U.prototype.rawValue=s(function e(t){return t[1]},"rawValue");U.prototype.getConfigTags=s(function e(t){if(d(t)){return t}else if(t&&typeof t==="object"){return t.tags}else{return void 0}},"getConfigTags");U.prototype.getConfigEscape=s(function e(t){if(t&&typeof t==="object"&&!d(t)){return t.escape}else{return void 0}},"getConfigEscape");var B={name:"mustache.js",version:"4.2.0",tags:["{{","}}"],clearCache:void 0,escape:void 0,parse:void 0,render:void 0,Scanner:void 0,Context:void 0,Writer:void 0,set templateCache(e){M.templateCache=e},get templateCache(){return M.templateCache}};var M=new U;B.clearCache=s(function e(){return M.clearCache()},"clearCache");B.parse=s(function e(t,n){return M.parse(t,n)},"parse");B.render=s(function e(t,n,r,a){if(typeof t!=="string"){throw new TypeError('Invalid template! Template should be a "string" but "'+m(t)+'" was given as the first argument for mustache#render(template, view, partials)')}return M.render(t,n,r,a)},"render");B.escape=I;B.Scanner=T;B.Context=R;B.Writer=U;var V=B;var N=Drupal.t("Frontpage",{},{context:"Global navigation mobile menu top level"});var q=Drupal.t("Open submenu:",{},{context:"Mobile navigation menu prefix"});var D=Drupal.t("Open parent menu:",{},{context:"Mobile navigation menu prefix"});Array.prototype.findRecursive=s(function e(t,n){if(!n){throw new Error("findRecursive requires parameter `childrenPropertyName`")}let r=[];r=this;const a=r.find(t);const i=r.filter(e=>e[n]);if(a){return a}if(i.length){const e=[];i.forEach(t=>{e.push(...t[n])});return e.findRecursive(t,n)}return void 0},"findRecursivelyFromArray");function F(){return this.sub_tree?.length>0}s(F,"button");function $(){let e;try{e=new URL(this.url).pathname}catch(t){e=this.url}return!this.external&&this.url&&e===window.location.pathname}s($,"isCurrentPath");function H(){return!!this.active}s(H,"isActive");function W(){return!!this.inPath}s(W,"isInPath");function J(){return!!this.is_injected}s(J,"isInjected");function z(){return{external:this.attributes["data-external"]||this.external||false,protocol:this.attributes["data-protocol"]||false}}s(z,"externalLinkAttributes");function G(){return!!this.attributes?.lang}s(G,"hasLang");function K(){if(!this.external){return false}return K.ICONS[this.attributes["data-protocol"]]||K.ICONS.external}s(K,"externalLinkIcon");K.ICONS={mailto:{class:"link__type link__type--mailto",text:Drupal.t("Link opens default mail program",{},{context:"Explanation for screen-reader software that the icon visible next to this link means that the link opens default mail program."})},tel:{class:"link__type link__type--tel",text:Drupal.t("Link starts a phone call",{},{context:"Explanation for screen-reader software that the icon visible next to this link means that the link starts a phone call."})},external:{class:"link__type link__type--external",text:Drupal.t("Link leads to external service",{},{context:"Explanation for screen-reader software that the icon visible next to this link means that the link leads to an external service."})}};var Q={compileTemplates(){this.templates={panel:`\n  {{#panels}}\n    <section class="{{panel_class}}">\n      <div class="mmenu__panel-body">\n        {{#back}}\n          <button class="mmenu__back">\n            <span class="visually-hidden">{{openParentMenuTranslation}}</span>\n            <span class="mmenu__back-wrapper">{{back}}</span>\n          </button>\n        {{/back}}\n        <a href="{{url}}" class="mmenu__title-link{{#isInPath}} mmenu__title-link--in-path{{/isInPath}}"{{#isActive}} aria-current="page"{{/isActive}}\n\n        {{#externalLinkAttributes.external}}\n          data-external="true"\n        {{/externalLinkAttributes.external}}\n\n        {{#externalLinkAttributes.protocol}}\n          data-protocol="{{externalLinkAttributes.protocol}}"\n        {{/externalLinkAttributes.protocol}}\n\n        ><span class="mmenu__link__text"\n\n        {{#hasLang}}\n          lang="{{attributes.lang}}"\n        {{/hasLang}}\n\n        >{{name}}</span>{{#externalLinkIcon}} <span class="{{class}}"></span><span class="visually-hidden">({{ text }})</span>{{/externalLinkIcon}}</a>\n        {{>sub_tree}}\n      </div>\n      ${document.querySelector(".js-mmenu__footer")?.outerHTML}\n    </section>\n  {{/panels}}\n\n  {{^panels}}\n  <div class="mmenu__loading">\n    <div class="hds-loading-spinner">\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n  </div>\n  {{/panels}}\n  `,list:`\n    <ul class="mmenu__items">\n      {{#sub_tree}}\n        <li class="mmenu__item">\n          <a href="{{url}}" class="mmenu__item-link{{#isInPath}} mmenu__item-link--in-path{{/isInPath}}{{#isInjected}} mmenu__item-link--injected{{/isInjected}}"{{#isActive}} aria-current="page"{{/isActive}}\n          {{#externalLinkAttributes.external}}\n            data-external="true"\n          {{/externalLinkAttributes.external}}\n          {{#externalLinkAttributes.protocol}}\n            data-protocol={{externalLinkAttributes.protocol}}\n          {{/externalLinkAttributes.protocol}}\n\n          ><span class="mmenu__link__text"\n\n          {{#hasLang}}\n            lang="{{attributes.lang}}"\n          {{/hasLang}}\n\n            >{{name}}</span>{{#externalLinkIcon}} <span class="{{class}}"></span><span class="visually-hidden">({{ text }})</span>{{/externalLinkIcon}}\n          </a>\n          {{#button}}\n            <button class="mmenu__forward " value={{id}}><span class="visually-hidden">{{openSubMenuTranslation}} {{name}}</span></button>\n          {{/button}}\n        </li>\n      {{/sub_tree}}\n    </ul>\n   `}},menu:null,templates:null,scroll_threshold:100,size:10,running:false,data:null,currentIndex:0,cacheKey:"hdbt-mobile-menu",enableCache:false,selectors:{container:"#mmenu",rootId:"mmenu__panels",forward:"mmenu__forward",back:"mmenu__back",dropdown:"js-menu-dropdown"},getAPIUrl(){const e=new URL(drupalSettings?.helfi_navigation?.links?.api);e.searchParams.set("_format","json");e.searchParams.set("max-depth",drupalSettings?.menu_depth);return e.toString()},getRoot(){return document.getElementById(this.selectors.rootId)},sortPanelsByPath(){const e=[];const t=this.data;const n=t.findRecursive(e=>$.call(e),"sub_tree");let r=n?.sub_tree?.length?n.id:n?.parentId;while(r){const n=t.findRecursive(({id:t,url:n,name:a,sub_tree:i,parentId:s,inPath:o,active:l})=>{if(t===r){e.push({sub_tree:i,name:a,url:n,parentId:s,inPath:o,active:l});r=s;return true}return false},"sub_tree");if(!n){r=void 0}}e.push({sub_tree:t,inPath:true});e.reverse();this.currentIndex=e.length-1;this.content=[...e]},content:[],getView(e){return this.content.map((t,n)=>({...t,name:t?.name||N,url:t.url||drupalSettings.helfi_navigation.links.canonical,button:F,isActive:H,isInPath:W,isInjected:J,externalLinkAttributes:z,hasLang:G,externalLinkIcon:K,back:n>0?this.content.at(n-1)?.name??(window.no_global_navigation?false:N):false,openSubMenuTranslation:q,openParentMenuTranslation:D,panel_class:(0,h.default)({mmenu__panel:true,"mmenu__panel--visible":true,"mmenu__panel--current":n===this.currentIndex,"mmenu__panel--visible-right":e==="start"&&n>this.currentIndex||e==="up"&&n>=this.currentIndex||e==="down"&&n>this.currentIndex+1,"mmenu__panel--visible-left":e==="up"&&n<this.currentIndex-1||e==="down"&&n<=this.currentIndex})}))},up(e){if(!e){throw new Error(`Id missing for next menu item  ${e}`)}const t=this.content.at(this.currentIndex).sub_tree.find(({id:t})=>t===e);if(!t){throw new Error(`ID mismatch in menu items${e}`)}this.currentIndex=this.currentIndex+1<this.size?this.currentIndex+1:this.currentIndex;this.content[this.currentIndex]=t;this.render("up")},down(){if(this.currentIndex===0){return}this.currentIndex=this.currentIndex-1>=0?this.currentIndex-1:this.currentIndex;this.render("down")},render(e){const t=this.getRoot();t.innerHTML=V.render(this.templates.panel,{panels:this.getView(e)},{sub_tree:this.templates.list});if(e==="load"){return}const n=[...t.querySelectorAll(".mmenu__panel")];const r=n.at(this.currentIndex);if(t.parentElement.scrollTop>this.scroll_threshold&&this.currentIndex>0){r.querySelector(".mmenu__back").scrollIntoView({block:"start",behaviour:"smooth"})}setTimeout(()=>{r.classList.remove("mmenu__panel--visible-right","mmenu__panel--visible-left");switch(e){case"up":n.at(this.currentIndex-1).classList.add("mmenu__panel--visible-left");break;case"down":n.at(this.currentIndex+1).classList.add("mmenu__panel--visible-right");break;default:}setTimeout(()=>{n.forEach(e=>{if(!e.classList.contains("mmenu__panel--current")){e.style.visibility="hidden"}})},200)},10)},async load(){const e=await fetch(this.getAPIUrl());const t=await e.json();const n=Object.getOwnPropertyNames(t);if(!n.length){throw new Error("No instances found in data",t)}const r=n.map(e=>{const n=t[e].menu_tree[0];n.parentId="";return n});const a=r.findRecursive(e=>$.call(e),"sub_tree");if(a){window.no_global_navigation=a.no_global_navigation;a.active=true;a.inPath=true}let i=a?.parentId;while(i){const e=r.findRecursive(e=>{if(e.id===i){i=e.parentId;e.inPath=true;return true}return false},"sub_tree");if(!e){i=void 0}}this.data=r},async start(){const e=document.querySelector(this.selectors.container);if(!this.getRoot()||!e){throw new Error("Panel root not found")}e.classList.add("mmenu--visible");this.render("load");try{await this.load()}catch(e){console.error("Unable to load menu API, using fallback menu instead",e);this.enableFallback();return}this.sortPanelsByPath();this.render("start");this.getRoot().addEventListener("click",e=>{const{target:{classList:t,value:n,parentElement:r}}=e;e.stopImmediatePropagation();if(t?.contains(this.selectors.forward)){this.up(n)}else if(t?.contains(this.selectors.back)||r?.classList?.contains(this.selectors.back)){this.down()}})},isOpen(){return window.location.hash==="#menu"||this.toggleButton.getAttribute("aria-expanded")==="true"},disableFallback(){this.menu.dataset.js=true},enableFallback(){this.menu.dataset.target="false";this.getRoot().innerHTML="";delete this.menu.dataset.js;window.location.hash="#menu"},close(){this.dropdownInstance.classList.add("nav-toggle-dropdown--closed");this.toggleButton.setAttribute("aria-expanded","false");this.menu.dataset.target="false";if(this.onClose){this.onClose()}},open(){this.dropdownInstance.classList.remove("nav-toggle-dropdown--closed");this.menu.dataset.target="true";this.toggleButton.setAttribute("aria-expanded","true");if(this.onOpen){this.onOpen()}},toggle(){if(this.isOpen()){this.close()}else{this.open()}this.toggleButton.focus()},init({onOpen:e,onClose:t}){if(this.running){console.warn("MobilePanel already initiated. Is it include more than once?");return}this.onOpen=e;this.onClose=t;this.toggleButton=document.querySelector(".js-menu-toggle-button");if(!this.toggleButton){throw new Error("No toggle button for JS menu.")}this.dropdownInstance=document.querySelector(`.${this.selectors.dropdown}`);if(!this.dropdownInstance){throw new Error("No dropdown element for JS menu.")}this.dropdownInstance.classList.add("nav-toggle-dropdown--closed");this.menu=document.querySelector("#menu");if(!this.menu){console.error("Panel not present in DOM. Cannot start JS mobile menu");return}this.disableFallback();document.addEventListener("keydown",e=>{if(e.key==="Escape"&&this.isOpen()){this.close();this.toggleButton.focus()}});const n=s(()=>{this.compileTemplates();this.toggleButton.removeEventListener("click",n);this.start()},"start");this.toggleButton.addEventListener("click",n);this.toggleButton.addEventListener("click",()=>this.toggle());if(this.isOpen()){window.location.hash="";n();this.open()}this.running=true}};var X=Q})();